<form (submit)="sendRequest()" [formGroup]="form" autocomplete="off">
  <div class="grid gap-4 sm:gap-6 lg:grid-cols-2 xl:grid-cols-3">
    <app-input
      id="name"
      placeholder=""
      label="الاسم"
      (valueChange)="onInputChange($event, 'name')"
    />

    <app-input
      id="code"
      placeholder=""
      label="الكود"
      (valueChange)="onInputChange($event, 'code')"
    />

    <app-input
      id="submissionNumber"
      placeholder=""
      label="رقم الطلب"
      (valueChange)="onInputChange($event, 'submissionNumber')"
    />

    <app-input
      id="passportNumber"
      placeholder=""
      label="رقم جواز السفر"
      (valueChange)="onInputChange($event, 'passportNumber')"
    />

    <app-select-input
      id="nationality"
      label="الجنسيه"
      [options]="countries()"
      (valueChange)="onInputChange($event, 'nationality')"
      [control]="getControl('nationality')"
    />

    <app-select-input
      id="gender"
      label="النوع"
      [options]="genderValues"
      (valueChange)="onInputChange($event, 'gender')"
      [control]="getControl('gender')"
    />
  </div>

  @if (!isLoading()) {

  <button
    type="submit"
    class="inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center text-white bg-cyan-700 rounded-lg focus:ring-4 focus:ring-cyan-200 hover:bg-cyan-800 hover:ring-cyan-800 hover:cursor-pointer my-5"
  >
    بحث
  </button>
  } @else {
  <app-loading-spinner />

  } @if (isLoadingReport()) {
  <app-loading-spinner />
  } @else {
  <button
    (click)="downloadReport()"
    class="inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center text-white bg-cyan-700 rounded-lg focus:ring-4 focus:ring-cyan-200 hover:bg-cyan-800 hover:ring-cyan-800 hover:cursor-pointer m-5"
  >
    تقرير
  </button>

  }
</form>

@if (reportsResult().length > 0) {

<app-reports-main-table [reportsArray]="reportsResult()" />

<!-- Pagination Controls -->
<div class="flex flex-col items-center justify-center mt-4 gap-2" dir="rtl">
  <div class="flex items-center gap-4">
    <span class="text-sm text-gray-700">
      صفحة
      <span class="font-semibold text-gray-900">{{ currentPage() }}</span> من
      <span class="font-semibold text-gray-900">{{ totalPages() }}</span>
    </span>
    <div class="flex items-center gap-2">
      <label for="limitSelect" class="text-sm text-gray-700"
        >عدد النتائج:</label
      >
      <select
        id="limitSelect"
        [value]="limit()"
        (change)="changeLimit($event)"
        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-cyan-500 focus:border-cyan-500 p-1.5"
      >
        @for (option of limitOptions; track option) {
        <option [value]="option" [selected]="option === limit()">
          {{ option }}
        </option>
        }
      </select>
    </div>
  </div>
  <div class="inline-flex mt-2 xs:mt-0">
    <button
      (click)="changePage(currentPage() - 1)"
      [disabled]="currentPage() === 1"
      class="flex items-center justify-center px-3 h-8 text-sm font-medium text-white bg-cyan-700 rounded-s hover:bg-cyan-800 disabled:opacity-50 disabled:cursor-not-allowed"
    >
      السابق
    </button>
    <button
      (click)="changePage(currentPage() + 1)"
      [disabled]="currentPage() === totalPages()"
      class="flex items-center justify-center px-3 h-8 text-sm font-medium text-white bg-cyan-700 border-0 border-s border-cyan-600 rounded-e hover:bg-cyan-800 disabled:opacity-50 disabled:cursor-not-allowed"
    >
      التالي
    </button>
  </div>
</div>

}
